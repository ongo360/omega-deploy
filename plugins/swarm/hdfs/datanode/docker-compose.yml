version: '2'
services:
 datanode-holder:
  image: centos:6.7
  restart: always
  environment:
   - TERM=xterm
  command: top -b -d 60
  environment:
   - "affinity:container!=*_datanode-holder_*"
 hdfs-datanode:
  image: uhopper/hadoop-datanode
  network_mode: service:datanode-holder
  depends_on: 
   - datanode-holder
  restart: always
  volumes:
   - /hadoop/dfs/data:/hadoop/dfs/data
  environment:
   - "affinity:container!=*_hdfs-datanode_*"
   - "CORE_CONF_fs_defaultFS=hdfs://namenode:8020"
networks:
 default:
  external: 
   name: ${NETWORK} 
